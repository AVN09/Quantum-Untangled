<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="stylesheet" type="text/css" href="posts.css"><title>A clever quantum trick</title></head><body><article class="h-entry">
<header>
<h1 class="p-name">A clever quantum trick</h1>
</header>
<section data-field="subtitle" class="p-summary">
Phase kickback is must-have knowledge for any quantum computing enthusiast or programmer, let’s see how it works.
</section>
<section data-field="body" class="e-content">
<section name="c2e6" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="bbf2" id="bbf2" class="graf graf--h3 graf--leading graf--title">A clever quantum trick</h3><h4 name="b182" id="b182" class="graf graf--h4 graf-after--h3 graf--subtitle">Phase kickback is must-have knowledge for any quantum computing enthusiast or professional, let’s see how it works and is used in other quantum algorithms.</h4><p name="7c29" id="7c29" class="graf graf--p graf-after--h4">Quantum computing is full of clever tricks that help us solve problems that would take us years to solve with purely classical computing. These tricks usually involve a relatively small circuit that performs a specific task inside a much bigger algorithm. In fact, quantum computing is all about learning how to take advantage of the strange tricks that inhabit quantum mechanics to solve problems through computation. You may have heard about some of these tricks, such as entanglement and superposition. There are many more, and among them you will find phase kickback.</p><p name="bef6" id="bef6" class="graf graf--p graf-after--p">Phase kickback is a very common and useful trick that you will often see included in larger quantum algorithms, e.g., Shor’s, Simon’s, Deutsch-Josza, and Grover’s. This is why it’s important to understand it, it will help you understand other much more practical circuits intuitively and have an idea of what is going on under the hood rather than just looking at the broad idea.</p><p name="3ee2" id="3ee2" class="graf graf--p graf-after--p">We will be looking at a really simple example that just involves two qubits. One important requirement that we need to take into account in order for this trick to work is that the qubit that will be the target in the control operation, in our case qubit q1, needs to be an eigenvector of the operation. If you don’t know what an eigenvector is, I’d recommend watching <a href="https://www.youtube.com/watch?v=PFDu9oVAE-g" data-href="https://www.youtube.com/watch?v=PFDu9oVAE-g" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">this video</a> by the great 3Blue1Brown.</p><p name="157c" id="157c" class="graf graf--p graf-after--p">What we want to achieve with this requirement is that applying the operation to our target qubit doesn’t change its state, but only affects its phase. Thus, applying the operator to our qubit would look something like this:</p><figure name="8c09" id="8c09" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8G9bPII9sWOUKzwlvk-tpw.png" data-width="402" data-height="100" alt="Equation showing state psi is an eigenvector of operation U" src="https://cdn-images-1.medium.com/max/800/1*8G9bPII9sWOUKzwlvk-tpw.png"><figcaption class="imageCaption">Ket psi is an eigenvector of the operator U with eigenvalue e^(iθ)</figcaption></figure><p name="8e1b" id="8e1b" class="graf graf--p graf-after--figure">In this example, U is the operation (a matrix) that is acting on the qubit psi (a vector represented by a ket). As you can see, the operator only adds a phase to our qubit, but doesn’t change its state. This value that the qubit psi is being multiplied by is the phase that will be kicked back to our control qubit.</p><p name="fdab" id="fdab" class="graf graf--p graf-after--p">With this requirement established, we can get into the circuit. First of all, let’s look at what the circuit looks like, and we will go through what each gate does next.</p><figure name="9074" id="9074" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*rZQ_CqPOe7zKAnLbVXxNRg.jpeg" data-width="361" data-height="261" alt="Quantum circuit for phase kickback" src="https://cdn-images-1.medium.com/max/800/1*rZQ_CqPOe7zKAnLbVXxNRg.jpeg"><figcaption class="imageCaption">Basic phase kickback quantum circuit</figcaption></figure><p name="f3c5" id="f3c5" class="graf graf--p graf-after--figure">First, our top qubit goes through a Hadamard gate and the bottom qubit goes through a Pauli-X gate, giving us the following state:</p><figure name="e3a0" id="e3a0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*d6dQftTm0KRLat7ihdXq2Q.png" data-width="497" data-height="185" alt="First equation, equal probability of states 01 and 11" src="https://cdn-images-1.medium.com/max/800/1*d6dQftTm0KRLat7ihdXq2Q.png"><figcaption class="imageCaption">First equation, showing an equal superposition between states 01 and 11</figcaption></figure><p name="677c" id="677c" class="graf graf--p graf-after--figure">We can see that we have an equal superposition of the states 01 and 11, where the first number corresponds to the qubit q0 and the second number to the qubit 11. This state is produced because the Hadamard gate puts our top qubit into an equal superposition between states 0 and 1 and the Pauli-X gate simply puts our bottom qubit into the state 1 no matter what.</p><p name="10c0" id="10c0" class="graf graf--p graf-after--p">Here is when it gets interesting. The qubits go through a controlled phase gate, with the control qubit being the top one and the target qubit the bottom one. The names control and target are misleading in this case, since the qubit that ends up changing its phase is the <strong class="markup--strong markup--p-strong">control</strong> qubit. Remember that a controlled gate acts only when the control qubit is in state 1, so the phase rotation is only applied in this case. When passing through this gate, the resulting state is the following:</p><figure name="9574" id="9574" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*tdJ210uCJgowK-POdRakLA.png" data-width="1012" data-height="139" alt="Second equation, demonstrating the relative phase in the first qubit" src="https://cdn-images-1.medium.com/max/800/1*tdJ210uCJgowK-POdRakLA.png"><figcaption class="imageCaption">Second equation, demonstrating the relative phase in the first qubit</figcaption></figure><p name="dc9b" id="dc9b" class="graf graf--p graf-after--figure">Remember the requirement we talked about earlier? Well, you can see it in action right here. The phase gate was applied to the state 11 (since the top qubit, which acts as the control, is in the state 1) but it only added a phase to the state. In this case, θ = π / 4, following the formula we showed above.<strong class="markup--strong markup--p-strong"> </strong>Another important remark is that the states are not entangled since we can write them as a tensor product of the two qubits.</p><p name="18ea" id="18ea" class="graf graf--p graf-after--p">We can see the effect of the phase with the statevector simulation that Qiskit gives us, notice that the top qubit (qubit 0) has a phase rotation, while the target qubit is right in the 1 state without any rotation.</p><figure name="091e" id="091e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*22PrHbfEgqc4df7SV83m5A.jpeg" data-width="960" data-height="480" data-is-featured="true" alt="Final vector state of both qubits, a phase rotation is showed in qubit 0" src="https://cdn-images-1.medium.com/max/800/1*22PrHbfEgqc4df7SV83m5A.jpeg"><figcaption class="imageCaption">Final vector state of both qubits</figcaption></figure><p name="b842" id="b842" class="graf graf--p graf-after--figure">This shows that the phase was kicked back into our top qubit rather than being applied to the bottom qubit. This is the effect we wanted to achieve, we applied a phase rotation to our top qubit but the qubit that actually was acted on by a phase rotation gate was the bottom qubit.</p><p name="3bd2" id="3bd2" class="graf graf--p graf-after--p">It’s also important to emphasize here that this phase cannot actually be seen by a measurement. In fact, measuring these qubits would still result in an equal probability of states 0 and 1 for qubit 0 and state 1 all of the time for qubit 1, the same we had in our first equation. We are just able to see this statevectors that illustrate the phase of the qubits because Qiskit has a statevector simulator, but running this circuit on real hardware would produce nothing too special.</p><p name="5cea" id="5cea" class="graf graf--p graf-after--p">So, why do we bother on altering this phase if we are not going to detect it when measuring? Well, as I said earlier, this circuit is very helpful in other algorithms. It may not look like it at first, but I assure you it is. Let’s go through a quick example in Grover’s search algorithm so you can appreciate the usefulness of phase kickback.</p><p name="cbf1" id="cbf1" class="graf graf--p graf-after--p">This search algorithm consists of many steps. One of them is to flip the sign of the state we are looking for. This means that we want to kick back a negative phase to this specific state, and how can we do that? Phase kickback! Of course, it is much harder than it sounds like. We need to design an oracle that only applied the negative phase to the state we are looking for, and this is very hard. But at the end the concept it relies on is phase kickback. If want to learn more about Grover’s search algorithm, I recommend starting <a href="https://qiskit.org/textbook/ch-algorithms/grover.html" data-href="https://qiskit.org/textbook/ch-algorithms/grover.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p><p name="dc49" id="dc49" class="graf graf--p graf-after--p">You can find python code implementing the phase kickback circuit showed through this article <a href="https://github.com/epelaaez/QuantumLibrary/blob/master/algorithms/basic_phase_kickback/basic_phase_kickback.py" data-href="https://github.com/epelaaez/QuantumLibrary/blob/master/algorithms/basic_phase_kickback/basic_phase_kickback.py" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>. This github repository contains implementations of various quantum algorithms, and the list is constantly growing and improving. Feel free to contribute to this project if you want to!</p><p name="e722" id="e722" class="graf graf--p graf-after--p">If you want to read some more in-depth and technical articles in this topic, I recommend the following:</p><ul class="postList"><li name="db99" id="db99" class="graf graf--li graf-after--p"><a href="https://nosarthur.github.io/quantum%20information%20and%20computation/2018/01/26/kickback.html" data-href="https://nosarthur.github.io/quantum%20information%20and%20computation/2018/01/26/kickback.html" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Phase kickback by nosarthur.</a></li><li name="94cd" id="94cd" class="graf graf--li graf-after--li"><a href="https://qiskit.org/textbook/ch-algorithms/quantum-phase-estimation.html" data-href="https://qiskit.org/textbook/ch-algorithms/quantum-phase-estimation.html" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Quantum Phase Estimation in the Qiskit textbook.</a></li><li name="f0fa" id="f0fa" class="graf graf--li graf-after--li graf--trailing"><a href="https://arxiv.org/abs/quant-ph/9708016v1" data-href="https://arxiv.org/abs/quant-ph/9708016v1" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Quantum Algorithms Revisited by Cleve, R., Ekert, A., Macchiavello, C., and Mosca, M.</a></li></ul></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@epelaaez" class="p-author h-card">Emilio Peláez</a> on <a href="https://medium.com/p/54f27e2518a4"><time class="dt-published" datetime="2021-01-16T21:37:27.478Z">January 16, 2021</time></a>.</p><p><a href="https://medium.com/@epelaaez/a-clever-quantum-trick-54f27e2518a4" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on March 8, 2021.</p></footer></article></body></html>